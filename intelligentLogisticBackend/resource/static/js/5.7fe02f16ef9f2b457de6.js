webpackJsonp([5],{EaYx:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=t("woOf"),r=t.n(s),o=t("Xxa5"),i=t.n(o),n=t("exGp"),l=t.n(n),c=t("bBUo"),m=t("1h8J"),u=t("uaSg"),f={data:function(){return{city:{},formData:{name:"",address:"",latitude:"",longitude:"",description:"",phone:"",promotion_info:"",float_delivery_fee:5,float_minimum_order_amount:20,is_premium:!0,delivery_mode:!0,new:!0,bao:!0,zhun:!0,piao:!0,startTime:"",endTime:"",image_path:"",business_license_image:"",catering_service_license_image:""},rules:{name:[{required:!0,message:"请输入店铺名称",trigger:"blur"}],address:[{required:!0,message:"请输入详细地址",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话"},{type:"number",message:"电话号码必须是数字"}]},options:[{value:"满减优惠",label:"满减优惠"},{value:"优惠大酬宾",label:"优惠大酬宾"},{value:"新用户立减",label:"新用户立减"},{value:"进店领券",label:"进店领券"}],activityValue:"满减优惠",activities:[{icon_name:"减",name:"满减优惠",description:"满30减5，满60减8"}],baseUrl:u.b,baseImgPath:u.a,categoryOptions:[],selectedCategory:["快餐便当","简餐"]}},components:{headTop:c.a},mounted:function(){this.initData()},methods:{initData:function(){var e=this;return l()(i.a.mark(function a(){return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(m.g)();case 3:return e.city=a.sent,a.next=6,Object(m.j)();case 6:a.sent.forEach(function(a){if(a.sub_categories.length){var t={value:a.name,label:a.name,children:[]};a.sub_categories.forEach(function(e,a){0!=a&&t.children.push({value:e.name,label:e.name})}),e.categoryOptions.push(t)}}),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(0),console.log(a.t0);case 13:case"end":return a.stop()}},a,e,[[0,10]])}))()},querySearchAsync:function(e,a){var t=this;return l()(i.a.mark(function s(){var r;return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!e){s.next=11;break}return s.prev=1,s.next=4,Object(m.D)(t.city.id,e);case 4:(r=s.sent)instanceof Array&&(r.map(function(e){return e.value=e.address,e}),a(r)),s.next=11;break;case 8:s.prev=8,s.t0=s.catch(1),console.log(s.t0);case 11:case"end":return s.stop()}},s,t,[[1,8]])}))()},addressSelect:function(e){this.formData.latitude=e.latitude,this.formData.longitude=e.longitude,console.log(this.formData.latitude,this.formData.longitude)},handleShopAvatarScucess:function(e,a){1==e.status?this.formData.image_path=e.image_path:this.$message.error("上传图片失败！")},handleBusinessAvatarScucess:function(e,a){1==e.status?this.formData.business_license_image=e.image_path:this.$message.error("上传图片失败！")},handleServiceAvatarScucess:function(e,a){1==e.status?this.formData.catering_service_license_image=e.image_path:this.$message.error("上传图片失败！")},beforeAvatarUpload:function(e){var a="image/jpeg"===e.type||"image/png"===e.type,t=e.size/1024/1024<2;return a||this.$message.error("上传头像图片只能是 JPG 格式!"),t||this.$message.error("上传头像图片大小不能超过 2MB!"),a&&t},tableRowClassName:function(e,a){return 1===a?"info-row":3===a?"positive-row":""},selectActivity:function(){var e=this;this.$prompt("请输入活动详情","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){var t=a.value;if(null!=t){var s={};switch(e.activityValue){case"满减优惠":s={icon_name:"减",name:"满减优惠",description:t};break;case"优惠大酬宾":s={icon_name:"特",name:"优惠大酬宾",description:t};break;case"新用户立减":s={icon_name:"新",name:"新用户立减",description:t};break;case"进店领券":s={icon_name:"领",name:"进店领券",description:t}}e.activities.push(s)}else e.$message({type:"info",message:"请输入活动详情"})}).catch(function(){e.$message({type:"info",message:"取消输入"})})},handleDelete:function(e){this.activities.splice(e,1)},submitForm:function(e){var a,t=this;this.$refs[e].validate((a=l()(i.a.mark(function e(a){var s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=15;break}return r()(t.formData,{activities:t.activities},{category:t.selectedCategory.join("/")}),e.prev=2,e.next=5,Object(m.c)(t.formData);case 5:1==(s=e.sent).status?(t.$message({type:"success",message:"添加成功"}),t.formData={name:"",address:"",latitude:"",longitude:"",description:"",phone:"",promotion_info:"",float_delivery_fee:5,float_minimum_order_amount:20,is_premium:!0,delivery_mode:!0,new:!0,bao:!0,zhun:!0,piao:!0,startTime:"",endTime:"",image_path:"",business_license_image:"",catering_service_license_image:""},t.selectedCategory=["快餐便当","简餐"],t.activities=[{icon_name:"减",name:"满减优惠",description:"满30减5，满60减8"}]):t.$message({type:"error",message:s.message}),console.log(s),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:e.next=17;break;case 15:return t.$notify.error({title:"错误",message:"请检查输入是否正确",offset:100}),e.abrupt("return",!1);case 17:case"end":return e.stop()}},e,t,[[2,10]])})),function(e){return a.apply(this,arguments)}))}}},p={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("head-top"),e._v(" "),t("el-row",{staticStyle:{"margin-top":"20px"}},[t("el-col",{attrs:{span:12,offset:4}},[t("el-form",{ref:"formData",staticClass:"demo-formData",attrs:{model:e.formData,rules:e.rules,"label-width":"110px"}},[t("el-form-item",{attrs:{label:"店铺名称",prop:"name"}},[t("el-input",{model:{value:e.formData.name,callback:function(a){e.$set(e.formData,"name",a)},expression:"formData.name"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"详细地址",prop:"address"}},[t("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.querySearchAsync,placeholder:"请输入地址"},on:{select:e.addressSelect},model:{value:e.formData.address,callback:function(a){e.$set(e.formData,"address",a)},expression:"formData.address"}}),e._v(" "),t("span",[e._v("当前城市："+e._s(e.city.name))])],1),e._v(" "),t("el-form-item",{attrs:{label:"联系电话",prop:"phone"}},[t("el-input",{attrs:{maxLength:"11"},model:{value:e.formData.phone,callback:function(a){e.$set(e.formData,"phone",e._n(a))},expression:"formData.phone"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"店铺简介",prop:"description"}},[t("el-input",{model:{value:e.formData.description,callback:function(a){e.$set(e.formData,"description",a)},expression:"formData.description"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"店铺标语",prop:"promotion_info"}},[t("el-input",{model:{value:e.formData.promotion_info,callback:function(a){e.$set(e.formData,"promotion_info",a)},expression:"formData.promotion_info"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"店铺分类"}},[t("el-cascader",{attrs:{options:e.categoryOptions,"change-on-select":""},model:{value:e.selectedCategory,callback:function(a){e.selectedCategory=a},expression:"selectedCategory"}})],1),e._v(" "),t("el-form-item",{staticStyle:{"white-space":"nowrap"},attrs:{label:"店铺特点"}},[t("span",[e._v("品牌保证")]),e._v(" "),t("el-switch",{attrs:{"on-text":"","off-text":""},model:{value:e.formData.is_premium,callback:function(a){e.$set(e.formData,"is_premium",a)},expression:"formData.is_premium"}}),e._v(" "),t("span",[e._v("蜂鸟专送")]),e._v(" "),t("el-switch",{attrs:{"on-text":"","off-text":""},model:{value:e.formData.delivery_mode,callback:function(a){e.$set(e.formData,"delivery_mode",a)},expression:"formData.delivery_mode"}}),e._v(" "),t("span",[e._v("新开店铺")]),e._v(" "),t("el-switch",{attrs:{"on-text":"","off-text":""},model:{value:e.formData.new,callback:function(a){e.$set(e.formData,"new",a)},expression:"formData.new"}})],1),e._v(" "),t("el-form-item",{staticStyle:{"white-space":"nowrap"}},[t("span",[e._v("外卖保")]),e._v(" "),t("el-switch",{attrs:{"on-text":"","off-text":""},model:{value:e.formData.bao,callback:function(a){e.$set(e.formData,"bao",a)},expression:"formData.bao"}}),e._v(" "),t("span",[e._v("准时达")]),e._v(" "),t("el-switch",{attrs:{"on-text":"","off-text":""},model:{value:e.formData.zhun,callback:function(a){e.$set(e.formData,"zhun",a)},expression:"formData.zhun"}}),e._v(" "),t("span",[e._v("开发票")]),e._v(" "),t("el-switch",{attrs:{"on-text":"","off-text":""},model:{value:e.formData.piao,callback:function(a){e.$set(e.formData,"piao",a)},expression:"formData.piao"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"配送费",prop:"float_delivery_fee"}},[t("el-input-number",{attrs:{min:0,max:20},model:{value:e.formData.float_delivery_fee,callback:function(a){e.$set(e.formData,"float_delivery_fee",a)},expression:"formData.float_delivery_fee"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"起送价",prop:"float_minimum_order_amount"}},[t("el-input-number",{attrs:{min:0,max:100},model:{value:e.formData.float_minimum_order_amount,callback:function(a){e.$set(e.formData,"float_minimum_order_amount",a)},expression:"formData.float_minimum_order_amount"}})],1),e._v(" "),t("el-form-item",{staticStyle:{"white-space":"nowrap"},attrs:{label:"营业时间"}},[t("el-time-select",{attrs:{placeholder:"起始时间","picker-options":{start:"05:30",step:"00:15",end:"23:30"}},model:{value:e.formData.startTime,callback:function(a){e.$set(e.formData,"startTime",a)},expression:"formData.startTime"}}),e._v(" "),t("el-time-select",{attrs:{placeholder:"结束时间","picker-options":{start:"05:30",step:"00:15",end:"23:30",minTime:e.formData.startTime}},model:{value:e.formData.endTime,callback:function(a){e.$set(e.formData,"endTime",a)},expression:"formData.endTime"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"上传店铺头像"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.baseUrl+"/v1/addimg/shop","show-file-list":!1,"on-success":e.handleShopAvatarScucess,"before-upload":e.beforeAvatarUpload}},[e.formData.image_path?t("img",{staticClass:"avatar",attrs:{src:e.baseImgPath+e.formData.image_path}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),t("el-form-item",{attrs:{label:"上传营业执照"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.baseUrl+"/v1/addimg/shop","show-file-list":!1,"on-success":e.handleBusinessAvatarScucess,"before-upload":e.beforeAvatarUpload}},[e.formData.business_license_image?t("img",{staticClass:"avatar",attrs:{src:e.baseImgPath+e.formData.business_license_image}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),t("el-form-item",{attrs:{label:"上传餐饮服务许可证"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.baseUrl+"/v1/addimg/shop","show-file-list":!1,"on-success":e.handleServiceAvatarScucess,"before-upload":e.beforeAvatarUpload}},[e.formData.catering_service_license_image?t("img",{staticClass:"avatar",attrs:{src:e.baseImgPath+e.formData.catering_service_license_image}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),t("el-form-item",{attrs:{label:"优惠活动"}},[t("el-select",{attrs:{placeholder:e.activityValue},on:{change:e.selectActivity},model:{value:e.activityValue,callback:function(a){e.activityValue=a},expression:"activityValue"}},e._l(e.options,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-table",{staticStyle:{"min-width":"600px","margin-bottom":"20px"},attrs:{data:e.activities,align:"cneter","row-class-name":e.tableRowClassName}},[t("el-table-column",{attrs:{prop:"icon_name",label:"活动标题",align:"cneter",width:"120"}}),e._v(" "),t("el-table-column",{attrs:{prop:"name",label:"活动名称",align:"cneter",width:"120"}}),e._v(" "),t("el-table-column",{attrs:{prop:"description",align:"cneter",label:"活动详情"}}),e._v(" "),t("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(t){return e.handleDelete(a.$index)}}},[e._v("删除")])]}}])})],1),e._v(" "),t("el-form-item",{staticClass:"button_submit"},[t("el-button",{attrs:{type:"primary"},on:{click:function(a){return e.submitForm("formData")}}},[e._v("立即创建")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var d=t("VU/8")(f,p,!1,function(e){t("GapR")},null,null);a.default=d.exports},GapR:function(e,a){}});
//# sourceMappingURL=5.7fe02f16ef9f2b457de6.js.map